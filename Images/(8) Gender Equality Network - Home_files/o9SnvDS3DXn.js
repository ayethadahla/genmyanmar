if (self.CavalryLogger) { CavalryLogger.start_js(["hmS+W"]); }

__d("AdsMediaPanelImageBox.react",["cssVar","cx","errorCode","fbt","AdsBuyingTypes","AdsError","AdsErrorUtils","AdsImageLegacy","AdsImageValidation","AdsInstagramErrorUtils","AdsInstagramFields","AdsPageTypes","AdsStockImageSourceUtils","AdsTestIDs","AdsValidationIcon.react","AdsValidationIconType","BackgroundImage.react","ContextualDialog.react","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","GradientBox.react","Link.react","React","ReactDOM","ReactLayeredComponentMixin_DEPRECATED","SphericalMediaGyroIcon.react","debounce","getElementPosition","getViewportDimensions","joinClasses"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=b("AdsStockImageSourceUtils").MAX_STOCK_IMAGE_HEIGHT,l=b("AdsStockImageSourceUtils").MAX_STOCK_IMAGE_WIDTH;a=b("React").PropTypes;var m=parseInt("110px",10),n=parseInt("58px",10),o=n,p=n,q=20,r=b("AdsInstagramFields").INSTAGRAM_SPECIFIC_IMAGE_ERROR_KEYS,s={"default":null,disabled:null,selected:"_5ywk",removable:"_5ywl"};c=b("React").createClass({displayName:"AdsMediaPanelImageBox",mixins:[b("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{alt:a.string,buyingTypes:a.arrayOf(a.oneOf(Object.keys(b("AdsBuyingTypes")))),decoration:a.oneOf(Object.keys(s)),disableDimensionInfo:a.bool,image:a.instanceOf(b("AdsImageLegacy")).isRequired,imageSpec:a.object,isTooSmall:a.bool,igSpecificImageSpec:a.object,scaleImageFactor:a.number,useMediaPanelRedesign:a.bool,onDecorationIconClick:a.func,onImageClick:a.func,onImageDoubleClick:a.func},getDefaultProps:function(){return{decoration:"default",isTooSmall:!1}},getInitialState:function(){return{errorLevel:b("AdsError").Level.SUCCESS,imageReady:this.props.image.hasDimensions(),previewShown:!1,hovering:!1,isValidForFacebook:!0}},_isDisabled:function(){return this.props.decoration==="disabled"},_mayClickImages:function(){if(this._isDisabled())return!1;return!this.props.isTooSmall||this.state.errorLevel!==b("AdsError").Level.WARN?!0:this.state.isValidForFacebook},_getOnImageClick:function(){return this._mayClickImages()?this.props.onImageClick:null},_getOnImageDoubleClick:function(){return this._mayClickImages()?this.props.onImageDoubleClick:null},_mayShowPreviews:function(){return!this._isDisabled()&&this.props.image.isStockImage()},_getOnImageMouseEnter:function(){return this._mayShowPreviews()?this._showPreview:null},_getOnImageMouseLeave:function(){return this._mayShowPreviews()?this._hidePreview:null},_showPreview:function(){this._resetSchedulePreviewHide(),this.setState({previewShown:!0})},_hidePreview:function(){this._resetSchedulePreviewHide(),this.setState({previewShown:!1})},_onImageDimensionsReady:function(){this.isMounted()&&this.setState({imageReady:!0})},UNSAFE_componentWillReceiveProps:function(a){if(a.image.equals(this.props.image))return;var b=a.image.hasDimensions();this.setState({imageReady:b});b||a.image.setDimensionsReadyCallback(this._onImageDimensionsReady)},UNSAFE_componentWillMount:function(){this._setSchedulePreviewHide(b("debounce")(this._hidePreview,q)),this.state.imageReady||this.props.image.setDimensionsReadyCallback(this._onImageDimensionsReady),this.props.imageSpec&&this.props.image.resetValidation(this.props.imageSpec.placement),this.props.igSpecificImageSpec&&this.props.image.resetValidation(this.props.igSpecificImageSpec.placement)},componentWillUnmount:function(){this._resetSchedulePreviewHide(),this._setSchedulePreviewHide(null)},_setSchedulePreviewHide:function(a){var b=this;b._schedulePreviewHide=a},_resetSchedulePreviewHide:function(){var a=this;a._schedulePreviewHide.reset()},_renderDecorationIcon:function(){var a=this.props.onDecorationIconClick;return b("React").createElement(b("Link.react"),{className:"_40hk",tabIndex:a?null:-1,onClick:a,onMouseEnter:this._getOnImageMouseEnter(),onMouseLeave:this._getOnImageMouseLeave()},b("React").createElement("div",{className:"_5ywm"}))},_renderOverlay:function(){return!this._isDisabled()?null:b("React").createElement("div",{className:"_29wz"})},_renderImage:function(){__p&&__p();var a=this.props.image,c=this._calculateImageDimensions(),d=a.calculatedWidth,e=a.calculatedHeight,f=a.renderedWidth,g=a.renderedHeight,h=null,i=null,j=null;this.props.isTooSmall?(h=this._renderErrorIcon(),i=this._renderDimensionInfo(),j=this._renderOverlayGradient()):this.state.hovering&&(i=this._renderDimensionInfo(),j=this._renderOverlayGradient());var k=a.getThumbnailUrl()||a.getUrl();g=g||e||c.height;e=f||d||c.width;this.props.useMediaPanelRedesign&&(k=a.getHighResThumbnailUrl()||k);this.props.scaleImageFactor&&this.props.useMediaPanelRedesign&&(g*=this.props.scaleImageFactor,e*=this.props.scaleImageFactor);f=null;a.getIsSphericalPhoto()&&(f=this._renderSphericalGyroIcon());return b("React").createElement(b("FBOverlayContainer.react"),{className:"_29w-"},b("React").createElement(b("FBOverlayBase.react"),null,b("React").createElement("div",{className:a.isStockImage()?"":"_5ywo"},b("React").createElement(b("BackgroundImage.react"),{alt:this.props.alt,backgroundPosition:"0px",backgroundSize:"cover",height:g,loadingIndicatorStyle:"small",optimizeResizeSpeed:!0,ref:"image",src:k,style:this._getImageStyle(),width:e}))),j,b("React").createElement(b("FBOverlayElement.react"),{vertical:"bottom"},b("React").createElement("div",{className:"_20-u"},i,h,f)))},_renderOverlayGradient:function(){return this.props.disableDimensionInfo?null:b("React").createElement(b("FBOverlayElement.react"),{vertical:"bottom"},b("React").createElement(b("GradientBox.react"),{className:"_2_4q",color:"black",direction:"up"}))},_renderDimensionInfo:function(){if(this.props.disableDimensionInfo)return null;var a=this.props.image.isStockImage()?this._calculateFullSizeStockImageDimensions():this._getImageDimensions();return j._("{width} \u00d7 {height}",[j._param("width",a.width),j._param("height",a.height)])},_renderErrorIcon:function(){__p&&__p();var a=[];this.props.imageSpec&&a.push(this.props.imageSpec);this.props.igSpecificImageSpec&&a.push(this.props.igSpecificImageSpec);a=b("AdsImageValidation").getAdsErrorsForImage(this.props.image,a,this.props.buyingTypes);if(!a||a.length===0)return null;var c=this.props.imageSpec&&this.props.imageSpec.placement!==b("AdsPageTypes").INSTAGRAM_STREAM&&this.props.imageSpec.placement!==b("AdsPageTypes").INSTAGRAM_STORY&&a.every(function(a){return a.key!==1487015});c!==this.state.isValidForFacebook&&this.setState({isValidForFacebook:c});c=b("AdsErrorUtils").getLevelForErrors(a);c!==this.state.errorLevel&&this.setState({errorLevel:c});a=b("AdsErrorUtils").getAllErrorsAtLevel(a,c);return b("React").createElement(b("AdsValidationIcon.react"),{className:"_20-v",isError:c===b("AdsError").Level.WARN,messages:this._getErrorMessages(a,c),type:c===b("AdsError").Level.WARN?b("AdsValidationIconType").ERROR_IMAGE:b("AdsValidationIconType").WARNING})},_getErrorMessages:function(a,c){var d=a.filter(function(a){return!r.has(a.key)}).map(function(a){return a.message}),e=a.filter(function(a){return r.has(a.key)}),f;e.length>0&&(f=b("AdsInstagramErrorUtils").getCombinedErrorMessage(a.filter(function(a){return r.has(a.key)}),c));f&&d.push(f);return d},_renderSphericalGyroIcon:function(){return b("React").createElement(b("SphericalMediaGyroIcon.react"),{className:"_4d75"})},render:function(){var a="_5ywp"+(this.props.useMediaPanelRedesign?" _40hl":"");return b("React").createElement("div",{className:a},b("React").createElement("div",{className:b("joinClasses")("_1997",s[this.props.decoration],this.props.className),onMouseEnter:function(){return this.setState({hovering:!0})}.bind(this),onMouseLeave:function(){return this.setState({hovering:!1})}.bind(this)},b("React").createElement(b("Link.react"),{className:"_5ywq","data-test-decoration":this.props.decoration,"data-testid":b("AdsTestIDs").IMAGE_BOX,tabIndex:this.props.onImageClick?null:-1,onClick:this._getOnImageClick(),onDoubleClick:this._getOnImageDoubleClick(),onMouseEnter:this._getOnImageMouseEnter(),onMouseLeave:this._getOnImageMouseLeave()},this._renderImage()),this._renderOverlay(),this._renderDecorationIcon()))},renderLayers:function(){var a=this.props.image,c=this._mayShowPreviews()&&this.state.previewShown,d=a.getPreviewWidth(),e=a.getPreviewHeight(),f=null;if(!c)return{};c={height:String(e)+"px",width:String(d)+"px"};var g=b("getElementPosition")(b("ReactDOM").findDOMNode(this)),h=b("getViewportDimensions")(),i=g.x;h=h.width-g.x-g.width;f=i>h?"left":"right";return{preview:b("React").createElement(b("ContextualDialog.react"),{autoFocus:!1,contextRef:function(){return this.refs.image}.bind(this),position:f,shown:!0,style:c},b("React").createElement(b("BackgroundImage.react"),{backgroudSize:"cover",backgroundPosition:"0px",height:e,loadingIndicatorStyle:"large",optimizeResizeSpeed:!0,src:a.getPreviewUrl(),width:d}))}},_getSizeMultiplier:function(a,b,c){return Math.min(b/a.width,c/a.height)},_getStockImageSizeMultiplier:function(){return this._getSizeMultiplier(this._getStockImageVisibleDimensions(),m,n)},_fitDimensions:function(a,b,c){b=this._getSizeMultiplier(a,b,c);return{height:Math.floor(a.height*b),width:Math.floor(a.width*b)}},_getImageStyle:function(){__p&&__p();var a=this.props.image;if(!a.isStockImage()||!this.state.imageReady)return null;a=this._getStockImageVisibleDimensions();var b=this._getImageDimensions();b={height:b.height-a.height,width:b.width-a.width};a=this._getStockImageSizeMultiplier();var c={};b.height>0&&(c.marginBottom=String(Math.ceil(b.height*-a))+"px");b.width>0&&(c.marginRight=String(Math.ceil(b.width*-a))+"px");return c},_getImageDimensions:function(){return{height:this.props.image.height,width:this.props.image.width}},_getNonStockImageDimensions:function(){return{height:this.props.image.getThumbnailHeight()||this.props.image.height,width:this.props.image.getThumbnailWidth()||this.props.image.width}},_getStockImageVisibleDimensions:function(){return{height:this.props.image.getThumbnailHeight(),width:this.props.image.getThumbnailWidth()}},_calculateImageDimensions:function(){return this.props.image.isStockImage()?this._calculateStockImageDimensions():this._calculateNonStockImageDimensions()},_calculateNonStockImageDimensions:function(){return!this.state.imageReady?{height:p,width:o}:this._fitDimensions(this._getNonStockImageDimensions(),m,n)},_calculateStockImageDimensions:function(){if(!this.state.imageReady)return this._fitDimensions(this._getStockImageVisibleDimensions(),m,n);var a=this._getImageDimensions(),b=this._getStockImageSizeMultiplier();return{height:Math.floor(a.height*b),width:Math.floor(a.width*b)}},_calculateFullSizeStockImageDimensions:function(){var a=this.props.image;if(a.hasFullSizeDimensions())return{height:a.getFullSizeHeight(),width:a.getFullSizeWidth()};var b=a.getPreviewWidth();a=a.getPreviewHeight();var c=Math.min(l/b,k/a);return{height:Math.round(a*c),width:Math.round(b*c)}}});e.exports=c}),null);
__d("DynamicAdsProductReportingDialog.react",["cx","fbt","AdsArrowedCarousel.react","AdsImageLegacy","AdsMediaPanelImageBox.react","React","XUIButton.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=120,l=120,m=500;c=babelHelpers.inherits(n,b("React").PureComponent);i=c&&c.prototype;function n(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onClick(this.props.dynamicItem.id)}.bind(this),b}n.prototype.render=function(){var a=new(b("AdsImageLegacy"))({key:this.props.dynamicItem.id,renderedHeight:k,renderedWidth:l,url:this.props.dynamicItem.image_url}),c=this.props.isSelected?"selected":"default";return b("React").createElement("div",{className:"_4cdc"},b("React").createElement(b("AdsMediaPanelImageBox.react"),{decoration:c,disableDimensionInfo:!0,image:a,onDecorationIconClick:this.$1,onImageClick:this.$1}))};function o(a){var c=a.dynamicItems.map(function(c){return b("React").createElement(n,{dynamicItem:c,isSelected:a.selectedDynamicItemID===c.id,key:c.id,onClick:a.onClick})});return c}j=babelHelpers.inherits(a,b("React").PureComponent);j&&j.prototype;a.prototype.render=function(){return b("React").createElement(b("XUIDialog.react"),{shown:this.props.isShown,width:m},b("React").createElement(b("XUIDialogTitle.react"),null,h._("Report An Item In This Ad")),b("React").createElement(b("XUIDialogBody.react"),null,b("React").createElement("div",{className:"_3-8x _3-97"},b("React").createElement(b("XUIText.react"),null,h._("What would you like to report?"))),b("React").createElement(b("AdsArrowedCarousel.react"),{isArrowCentered:!0},b("React").createElement(o,{dynamicItems:this.props.dynamicItems,selectedDynamicItemID:this.props.selectedDynamicItemID,onClick:this.props.onSelect}))),b("React").createElement(b("XUIDialogFooter.react"),null,b("React").createElement(b("XUIButton.react"),{disabled:!this.props.selectedDynamicItemID,label:h._("Continue"),use:"confirm",onClick:this.props.onConfirm})))};function a(){j.apply(this,arguments)}e.exports=a}),null);
__d("DynamicAdsProductReportingDialogContainer.react",["invariant","AdsTransparencyViewAdsEntity","AdsTransparencyViewAdsEvent","DynamicAdsProductReportingDialog.react","PagesActiveAdsReportUtils","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={isShown:!0,selectedDynamicItemID:null},this.$1=function(){if(this.state.selectedDynamicItemID==null||this.state.selectedDynamicItemID==="")return;var a=this.props.context;a.product_ids=[this.state.selectedDynamicItemID];b("PagesActiveAdsReportUtils").startWebNFXDialog(a);this.setState({isShown:!1})}.bind(this),this.$2=function(a){this.props.logger.updateData({entity:b("AdsTransparencyViewAdsEntity").PRODUCT_ITEM,event:b("AdsTransparencyViewAdsEvent").CLICK,product_ids:[a]}).log(),this.setState({selectedDynamicItemID:a})}.bind(this),c}a.prototype.componentDidMount=function(){this.props.context.dynamic_items||g(0,5350);var a=this.props.context.dynamic_items.map(function(a){return a.id});this.props.logger.updateData({entity:b("AdsTransparencyViewAdsEntity").REPORT_DYNAMIC_ITEM,event:b("AdsTransparencyViewAdsEvent").IMPRESSION,product_ids:a}).log()};a.prototype.render=function(){this.props.context.dynamic_items||g(0,5350);return b("React").createElement(b("DynamicAdsProductReportingDialog.react"),{dynamicItems:this.props.context.dynamic_items,isShown:this.state.isShown,selectedDynamicItemID:this.state.selectedDynamicItemID,onConfirm:this.$1,onSelect:this.$2})};e.exports=a}),null);
__d("PagesActiveAdsReportProductAction",["AdsTransparencyViewAdsEntity","AdsTransparencyViewAdsEvent","AdsTransparencyViewAdsTypedLogger","DOM","DOMQuery","DynamicAdsProductReportingDialogContainer.react","EventListener","PagesActiveAdsReportUtils","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={registerReportProductClick:function(a,c,d){__p&&__p();b("EventListener").listen(a,"click",function(){__p&&__p();var a=b("PagesActiveAdsReportUtils").getReportMetadata(c);if(!a)return;var e=d;e.reportable_id=a.report_id;e.landing_page_id=a.landing_page_id;a=b("DOM").create("div");b("DOMQuery").getRootElement().appendChild(a);var f=new(b("AdsTransparencyViewAdsTypedLogger"))().setAdID(e.reportable_id).setPageID(e.landing_page_id).setEntity(b("AdsTransparencyViewAdsEntity").REPORT_DYNAMIC_ITEM);f.setEvent(b("AdsTransparencyViewAdsEvent").CLICK).log();b("ReactDOM").render(b("React").createElement(b("DynamicAdsProductReportingDialogContainer.react"),{context:e,logger:f}),a)})}};e.exports=a}),null);