if (self.CavalryLogger) { CavalryLogger.start_js(["7KwJ7"]); }

__d("TimelineUnitSelector",["csx","DOMQuery"],(function(a,b,c,d,e,f,g){a={getUnitsWithTime:function(a){return b("DOMQuery").scry(a,"._5jmm[data-time]")}};e.exports=a}),null);
__d("TimelineComposerUtilities",["csx","Arbiter","Bootloader","CSS","DOM","DOMQuery","Event","Parent","TimelineUnitSelector","Vector"],(function(a,b,c,d,e,f,g){__p&&__p();var h=86400*31,i=864e5,j={listenToSetEstimatedDate:function(a,c){return b("Arbiter").subscribe("ComposerXTimelineTagger/init",function(d,e){b("DOMQuery").contains(a,e.datePickerElement)&&(j.setEstimatedDate(e.datePickerInstance,c()),e.composerTimelineTagger.switchToTagger("date"))})},listenToPublish:function(a,c){a.root&&(a=a.root);return b("Arbiter").subscribe("composer/publish",function(event,d){d.composer_id===a.id&&b("Bootloader").loadModules(["TimelineStoryPublisher"],function(a){a.publish(d),c&&c()},"TimelineComposerUtilities")})},listenToAnotherComposerOpen:function(a,c){return b("Arbiter").subscribe("composer/mutate",function(b,d){d!==a&&c()})},listenToCancel:function(a,c){return b("Event").listen(a,"click",function(event){b("Parent").bySelector(event.getTarget(),"._306")&&c()})},setEstimatedDate:function(a,c){__p&&__p();var d,e;if(c&&b("CSS").hasClass(c,"fbTimelineCapsule")){d=c.getAttribute("data-start");e=c.getAttribute("data-end");if(d&&e){var f=new Date(e*1e3),g=new Date();f>g?a.setDate(g.getFullYear(),g.getMonth()+1,g.getDate()):e-d>2*h?a.setDate(f.getFullYear()):a.setDate(f.getFullYear(),f.getMonth()+1)}return}g=b("Parent").byClass(c,"fbTimelineCapsule");if(g){d=g.getAttribute("data-start");e=g.getAttribute("data-end");f=b("Vector").getElementPosition(c).y;c=[e,null];e=[d,null];d=b("TimelineUnitSelector").getUnitsWithTime(g);for(var g=0;g<d.length;g++){var j=d[g],k=b("DOM").scry(j.parentNode,".spinePointer")[0];if(!k)continue;k=b("Vector").getElementPosition(k).y;k<=f?(!c[1]||k>c[1])&&(c=[j.getAttribute("data-time"),k]):(!e[1]||k<e[1])&&(e=[j.getAttribute("data-time"),k])}if(c[0]!==null&&e[0]!==null){j=Math.round((parseInt(c[0],10)+parseInt(e[0],10))/2)*1e3;j=Math.min(new Date()-i,j);a.setDateWithTimestamp(j)}}}};e.exports=j}),null);
__d("TimelineLifeEventPhotoPreviewGrid",["csx","fbt","ActorURI","AsyncRequest","AsyncUploadRequest","Bootloader","Button","CSS","DOM","FileInputUploader","Parent","ProgressBar","SortableGroup","TimelineLifeEventPhotoConfig"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=1,j=2,k=3,l=[null,"mleOnePhoto","mleTwoPhotos","mleManyPhotos"];function a(a,c,d,e){"use strict";__p&&__p();this._container=a;this._containerID=a.id;this._grid=c;this._photoLimit=d;this._profileID=e;this._progressBarMarkup=b("TimelineLifeEventPhotoConfig").progressBarMarkup;this._loadingIndicators=[];this._pendingPhotoRequests=0;this._photoDisplayType=0;this._tempPhotoRef=[];this._saveButton=b("DOM").find(this._container,"._5mlk");if(!b("TimelineLifeEventPhotoConfig").enableDrag)return;this._sortableGroup=new(b("SortableGroup"))().setGrabCallback(n).setDropCallback(o);a=b("DOM").scry(c,".mlePhotoPreviewThumb");for(var d=0;d<a.length;d++)this._bindPhoto(a[d]);this._updatePhotoDisplayType(a.length)}a.prototype.destroy=function(){"use strict";this._sortableGroup&&this._sortableGroup.destroy()};a.prototype._getNumPhotos=function(){"use strict";return b("DOM").scry(this._grid,".mlePhotoPreviewThumb").length+b("DOM").scry(this._grid,".mlePhotoPlaceholder").length};a.prototype._getPhotoType=function(a){"use strict";switch(a){case 0:case 1:return i;case 2:return j;default:if(a<0||a>this._photoLimit)throw new Error("invalid number of photos");return k}};a.prototype._updatePhotoDisplayType=function(a){"use strict";var c=l[this._photoDisplayType];c&&b("CSS").removeClass(this._container,c);this._photoDisplayType=this._getPhotoType(a);b("CSS").addClass(this._container,l[this._photoDisplayType])};a.prototype._updateAddMorePhotosClass=function(){"use strict";this._pendingPhotoRequests>0?b("CSS").addClass(b("DOM").find(this._container,".mleAddMorePhotoButtons"),"disabled"):b("CSS").removeClass(b("DOM").find(this._container,".mleAddMorePhotoButtons"),"disabled")};a.prototype._updatePhotos=function(a,c){"use strict";__p&&__p();c=c;var d=[],e=this._photoDisplayType;this._updatePhotoDisplayType(a);if(this._photoDisplayType!==e){var f=b("DOM").scry(this._grid,".mlePhotoPreviewThumb");for(var g=0;g<f.length;g++){var h=b("DOM").find(f[g],".mlePhotoPreviewInput").value;d.push(h);this._photoDisplayType===k||e===k?(this._unbindPhoto(f[g]),b("DOM").remove(f[g]),this.createPlaceholder(h)):(b("CSS").addClass(f[g],"photoLoading"),b("CSS").hide(b("DOM").find(f[g],".detachPhotoIcon")),b("CSS").show(b("DOM").find(f[g],".photoLoadingSpinner")),this._unbindPhoto(f[g]),this._tempPhotoRef[h]=f[g])}}h=c.concat(d);if(h.length>0){this._pendingPhotoRequests+=h.length;this._photoDisplayType!==k&&this._updateAddMorePhotosClass();g=b("ActorURI").create("/ajax/timeline/mle_photo_select.php",this._profileID);new(b("AsyncRequest"))().setURI(g).setData({display_elem:this._containerID,existing_image_ids:d,field_name:"photos",image_ids:c,profile_id:this._profileID,total_photos:a}).setMethod("POST").send()}};a.prototype._bindPhoto=function(a){"use strict";this._sortableGroup&&this._sortableGroup.addSortable(b("DOM").find(a,"input").getAttribute("value"),a)};a.prototype._unbindPhoto=function(a){"use strict";this._sortableGroup&&this._sortableGroup.removeSortable(b("DOM").find(a,"input").getAttribute("value"))};a.prototype.filterPhotoClick=function(event){"use strict";this._pendingPhotoRequests>0&&this._photoDisplayType!=k&&event.kill()};a.prototype.attachPhoto=function(a,c){"use strict";__p&&__p();if(!this._loadingIndicators[c]&&!this._tempPhotoRef[c])return;if(this._tempPhotoRef[c])b("DOM").replace(this._tempPhotoRef[c],a),this._bindPhoto(a),delete this._tempPhotoRef[c];else{var d=this._loadingIndicators[c].getRoot();b("Parent").byTag(d,"body")&&(b("DOM").replace(d,a),this._bindPhoto(a));delete this._loadingIndicators[c]}--this._pendingPhotoRequests===0&&this._updateAddMorePhotosClass()};a.prototype.detachPhoto=function(a){"use strict";if(this._pendingPhotoRequests>0)return;this._unbindPhoto(a);b("DOM").remove(a);a=this._getNumPhotos();this._updatePhotos(a,[]);a===0?(b("CSS").show(b("DOM").find(this._container,".mlePhotoButtons")),b("CSS").hide(b("DOM").find(this._container,".mleAddMorePhotoButtons"))):a===this._photoLimit-1&&b("CSS").show(b("DOM").find(this._container,".mleAddMorePhotoButtons"))};a.prototype.createPlaceholder=function(a){"use strict";var c=this._progressBarMarkup.cloneNode(!0);c=b("DOM").appendContent(this._grid,c)[0];this._loadingIndicators[a]=new(b("ProgressBar"))(c);return c};a.prototype.addPhotos=function(a){"use strict";__p&&__p();var c=this._getNumPhotos(),d=a.length;c=c+d;if(c>this._photoLimit){var e=h._("The maximum number of photos you can add to this life event is {limit}. Please remove some photos and try again.",[h._param("limit",this._photoLimit)]);b("Bootloader").loadModules(["Dialog"],function(a){new a().setTitle(h._("Too Many Photos")).setBody(e).setButtons(a.OK).setCausalElement(this._container).show()}.bind(this),"TimelineLifeEventPhotoPreviewGrid");return}c===this._photoLimit&&b("CSS").hide(b("DOM").find(this._container,".mleAddMorePhotoButtons"));var f=a.slice(0,d);this._updatePhotos(c,f);for(var c=0;c<d;c++)this.createPlaceholder(a[c])};a.prototype.destroyPlaceholder=function(a){"use strict";if(!this._loadingIndicators[a])return;b("DOM").remove(this._loadingIndicators[a].getRoot());delete this._loadingIndicators[a]};a.prototype.initUploader=function(a,c){"use strict";var d=a.getInput();d.multiple=b("AsyncUploadRequest").isSupported();a.subscribe("change",this._uploadPhotos.bind(this,d,c))};a.prototype._setSaveButtonEnabled=function(a){"use strict";b("Button").setEnabled(this._saveButton,a)};a.prototype._uploadPhotos=function(a,c){"use strict";__p&&__p();b("CSS").hide(b("DOM").find(this._container,".mlePhotoButtons"));b("CSS").show(b("DOM").find(this._container,".mleAddMorePhotoButtons"));var d=this._getNumPhotos(),e=a.files?a.files.length:1;d=d+e;if(d>this._photoLimit){var f=h._({"*":"The maximum number of photos you can add to this life event is {limit}. Please remove some photos and try again."},[h._param("limit",this._photoLimit,[0])]);b("Bootloader").loadModules(["Dialog"],function(a){new a().setTitle(h._("Too Many Photos")).setBody(f).setButtons(a.OK).setCausalElement(this._container).show()}.bind(this),"TimelineLifeEventPhotoPreviewGrid");m(a);return}var g;for(var i=0;i<e;i++)g=a.files?a.files[i].name:a.value.split("\\").pop(),this.createPlaceholder(g);this._updatePhotos(d,[]);c.uploadData.total_photos=d;this._photoDisplayType!=k&&(this._pendingPhotoRequests+=e);i=new(b("FileInputUploader"))(a).setURI(c.uploadURI).setData(c.uploadData).setAllowCrossOrigin(!0).setUploadInParallel(!0);i.subscribe("progress",this._onProgress.bind(this));i.subscribe("success",this._onSuccess.bind(this));i.subscribe("failure",this._onFailure.bind(this,g));i.send();this._setSaveButtonEnabled(!1);m(a)};a.prototype._onProgress=function(a,c){"use strict";var event=c.event;a=this._loadingIndicators[c.upload.getFile().name];b("CSS").hide(b("DOM").find(a.getRoot(),".mlePhotoLoadingIndicator"));b("CSS").show(b("DOM").find(a.getRoot(),".mlePhotoProgressBar"));event.loaded==event.total?(a.setPosition(50),a.setTarget(100,2e3)):a.setPosition(50*event.loaded/event.total)};a.prototype._onSuccess=function(a,b){"use strict";this._setSaveButtonEnabled(!0)};a.prototype._onFailure=function(a){"use strict";this.destroyPlaceholder(a),this._setSaveButtonEnabled(!0)};function m(a){a.value="",a.files=null}function n(a){b("CSS").addClass(a,"dragging")}function o(a,c){b("CSS").removeClass(c,"dragging")}e.exports=a}),null);
__d("LifeEventDialogSurface",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({BLOOD_DONOR_REGISTRATION:"blood_donor_registration",COMPOSER:"composer",EDIT:"edit",FB4A_COMPOSER:"fb4a_composer",FEED_COMPOSER:"feed_composer",FEED_CTA:"feed_cta",FRIENDSHIP_PAGE:"friendship_page",HEADER:"header",INFOTAB_LIVING:"infotab_living",INFOTAB_YEAR_OVERVIEWS:"infotab_year_overviews",INTRO_CARD_CONTEXT_ITEM_EDIT:"intro_card_context_item_edit",IOS_COMPOSER:"ios_composer",MAP:"map",MAP_EDIT:"map_edit",MBASIC_COMPOSER:"mbasic_composer",MBASIC_PROFILE:"mbasic_profile",MTOUCH_COMPOSER:"mtouch_composer",MTOUCH_PROFILE:"mtouch_profile",MTOUCH_PROFILE_NUX:"mtouch_profile_nux",MTOUCH_PROFILE_REFRESHER:"mtouch_profile_refresher",MTOUCH_EDIT:"mtouch_edit",MTOUCH_YEAR_OVERVIEW:"mtouch_year_overview",MTOUCH_INFOTAB_LIVING:"mtouch_infotab_living",MTOUCH_V1_INFOTAB_LIVING:"mtouch_v1_infotab_living",PAGES_MORE_BUTTON:"pages_more_button",PROFILE:"profile",SNAPTU_COMPOSER:"snaptu_composer",TEST:"test",TIMELINE_SECTION_HEADER:"timeline_section_header",UNKNOWN:"unknown",WEBDRIVER_TEST:"webdriver_test",YEARLY_SUMMARY:"yearly_summary",YEAR_IN_REVIEW:"year_in_review",YEAR_OVERVIEW:"year_overview",GRAPHQL_PROFILE_ADD_SCHOOL:"graphql_profile_add_school",CONTEXT_ITEM_WIZARD:"context_item_wizard"})}),null);
__d("TimelineMLEPhotoPreview",["CSS","Dialog","DOM","Event","Layer","Parent","TimelineLifeEventPhotoPreviewGrid","$"],(function(a,b,c,d,e,f){__p&&__p();var g={},h={initPreviewGrid:function(a,c,d){var e=b("Parent").byClass(a,"mleContainer");if(!e)return;h.destroyPreviewGrid(e);g[e.id]=new(b("TimelineLifeEventPhotoPreviewGrid"))(e,a,c,d);b("Event").listen(b("DOM").find(e,".mleAddMorePhotoButtons"),"click",function(event){g[e.id].filterPhotoClick(event)})},destroyPreviewGrid:function(a){g[a.id]&&(g[a.id].destroy(),delete g[a.id])},initUploader:function(a,b,c){g[b]&&g[b].initUploader(a,c)},attachPhoto:function(a,b,c){g[a]&&g[a].attachPhoto(b,c)},listenForDetach:function(a,c){c=g[c];b("Event").listen(b("DOM").find(a,".detachPhotoIcon"),"click",c.detachPhoto.bind(c,a))},listenForPhotoSelect:function(a,c){__p&&__p();var d=b("$")(c.display_elem),e=!1;b("Event").listen(a,"click",function(){if(e)return;e=!0;b("CSS").hide(b("DOM").find(d,".mlePhotoButtons"));b("CSS").show(b("DOM").find(d,".mleAddMorePhotoButtons"));var a=b("Dialog").getCurrent();a&&a.hide();a=g[d.id];a&&a.addPhotos([c.photo_fbid])})},listenForSubmit:function(a,c,d){__p&&__p();var e=b("$")(d);a.subscribe("confirm",function(){__p&&__p();var d=b("DOM").scry(a.getContentRoot(),'input[name="'+c+'"]'),f=[];for(var h=0;h<d.length;h++){var i=d[h];i.checked===!0&&f.push(i.value)}b("CSS").hide(b("DOM").find(e,".mlePhotoButtons"));b("CSS").show(b("DOM").find(e,".mleAddMorePhotoButtons"));(i=b("Dialog").getCurrent())&&i.hide();(i=b("Layer").getTopmostLayer())&&i.hide();g[e.id]&&g[e.id].addPhotos(f)})}};e.exports=h}),null);
__d("XFamilyNonUserCreationFormController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/family/create/form/",{show_intro:{type:"Bool",defaultValue:!1},name:{type:"String"},relation:{type:"Int"},existing_relationship_id:{type:"Int"},prefilled_data:{type:"StringToStringMap"},source:{type:"String",defaultValue:"unknown"},waterfall_id:{type:"String"},birth_month:{type:"Int"},birth_day:{type:"Int"},birth_year:{type:"Int"},privacy_row:{type:"StringToIntMap"},relationship_type:{type:"Int"},__asyncDialog:{type:"Int"}})}),null);
__d("TimelineMLE",["cssVar","csx","fbt","Animation","Arbiter","AsyncRequest","Bootloader","ComposerXController","CSS","DOM","DOMScroll","Event","ExtensibleSproutsItemType","Form","LifeEventDialogSurface","Parent","PrivacySelector","ProgressiveDatepicker","ReactComposerActions","ReactComposerIDGenerator","RelationshipStatusConst","TimelineComposerUtilities","TimelineContentLoader","TimelineMLEPhotoPreview","XFamilyNonUserCreationFormController","$","areJSONRepresentationsEqual","destroyOnUnload","ge","tidyEvent"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=0,k={},l=null,m=null,n=50;function o(a){return b("Parent").byClass(a,"mleFlyoutForm")}function p(a){a=b("Parent").byClass(a.getContext(),"fbTimelineCapsule");return a?a:b("TimelineContentLoader").capsuleForCurrentSection()}function q(a){var c=b("Form").serialize(a);s(a,c);r(a,c);b("areJSONRepresentationsEqual")(c,k.state)||(u(a),new(b("AsyncRequest"))().setData(c).setURI("/ajax/timeline/mle_header.php").setRelativeTo(a).setFinallyHandler(b("Arbiter").inform.bind(b("Arbiter"),"TimelineMLE/mleHeaderUpdated")).send())}function r(a,c){a=b("DOM").scry(a,"._594n")[0];if(!a)return;c=Object.prototype.hasOwnProperty.call(c,"name")?c.name:c.text_with&&c.text_with[0];c&&b("DOM").setContent(a,i._("{name} will be added to the Family section on your profile.",[i._param("name",c)]));b("CSS").conditionClass(a,"hidden_elem",!c)}function s(a,c){__p&&__p();var d=parseInt(c.type,10),e=c["with"],f=b("DOM").scry(a,"input.updateRelationshipStatus")[0];if(!f)return;var g=b("DOM").scry(a,"li.relationshipConfirmation")[0];if(!g)return;var h=b("DOM").find(a,"li.relationshipTooManyPartners");if(e&&e.length>1){b("CSS").hide(g);b("CSS").show(h);f.checked=!1;f.disabled=!0;return}b("CSS").hide(h);f.disabled=!1;h=e&&e[0];e=b("DOM").find(a,"input.relationshipCurrentPartnerID").value;var i=b("DOM").find(a,"input.relationshipCurrentStatus").value,j=b("RelationshipStatusConst").isUnilateralStatus(d);f=f.checked&&!j&&h&&(e!=h||i!=d);if(h){j=c.text_with[0];e=b("DOM").find(a,"span.relationshipPartnerName");b("DOM").setContent(e,j)}b("CSS").conditionClass(g,"hidden_elem",!f)}function t(a,c){a=b("DOM").find(a,".mleIconField");a.value=c;z.updateHeader(a)}function u(a){a=a||k.element;if(!a)return;k={element:a,state:b("Form").serialize(a)}}function v(event){__p&&__p();var a=event.getTarget(),c=a.options[a.selectedIndex];b("Arbiter").inform("TimelineMLE/mleSelectUpdated",a);a=b("Parent").byClass(c,"mleFormContainer");if(a instanceof HTMLFormElement){q(a);var d=b("DOM").scry(a,".mleOtherLabel");a=b("DOM").scry(a,".mleOtherField");d.length&&(d=d[0]);a.length&&(a=a[0]);if(b("CSS").hasClass(c,"mleOther")){b("CSS").show(d);b("CSS").show(a);c=b("DOM").find(a,".inputOuter").firstChild;c.focus()}else b("CSS").hide(d),b("CSS").hide(a)}}function w(a,c){b("DOM").replace(b("$")(a),c)}function x(a){a&&b("Event").listen(a,"change",v)}function y(a,c){new(b("Animation"))(a).to("background",c).duration(n).go()}var z={addRequiredValidationToField:function(a){var c=i._("This field is required."),d=a.placeholder;b("Event").listen(a,"blur",function(b){if(a.value===null||a.value.length===0){a.placeholder=String(c);b="#ffbaba";y(a,b)}});b("Event").listen(a,"focus",function(b){a.placeholder===c&&(a.placeholder=d,y(a,"#FFFFFF"))})},cancel:function(a){__p&&__p();if(o(a))z.hideFlyout();else{var c=b("Parent").byClass(a,"mleContainer");c&&b("TimelineMLEPhotoPreview").destroyPreviewGrid(c);c=b("Parent").byClass(a,"fbTimelineNewMLE");c?b("DOM").remove(c):(c=b("Parent").byClass(a,"fbTimelineEditMLE"),c&&(b("CSS").removeClass(c,"fbTimelineEditMLE"),b("DOM").remove(b("DOM").scry(c,".timelineUnitContainer")[0]),b("CSS").show(b("DOM").scry(c,".timelineUnitContainer")[0])));b("Arbiter").inform("TimelineMap/resizeCallout")}k={};return!1},registerButtons:function(a,c,d,e){b("tidyEvent")(b("Event").listen(c,"mousedown",function(){a.standalone&&l?l.setStackable(!1):b("DOM").setContent(b("DOM").find(e,".mleInlineErrorMsg"),"")})),a.location===b("LifeEventDialogSurface").COMPOSER&&b("tidyEvent")(b("Event").listen(c,"click",function(){a.composerID&&b("ReactComposerActions").postStartedLoggingOnlyDoNotUse(a.composerID,b("ExtensibleSproutsItemType").MILESTONE)})),d&&b("tidyEvent")(b("Event").listen(d,"click",function(c){c.prevent(),a.location==="map"&&b("Arbiter").inform("TimelineMap/cancelCreation"),a.standalone?z.hideFlyout():d&&z.cancel(d)}))},registerStickyPrivacyFlyout:function(a){b("Arbiter").subscribe("TimelineMLE/mleFlyoutHidden",a.hide.bind(a)),b("Arbiter").subscribe("TimelineMLE/mleHeaderUpdated",a.updatePosition.bind(a))},replace:function(a,c){__p&&__p();var d=b("Parent").byClass(a,"mleContainer");d&&b("TimelineMLEPhotoPreview").destroyPreviewGrid(d);if(o(a)){d=b("Parent").byClass(a,"fbTimelineEditMLEFlyout");a=b("Parent").byClass(a,"mleFlyoutPagesMoreButton");if(d){d=b("ge")(c.relativeElementID);if(!d){z.hideFlyout();return}d=b("Parent").byClass(d,"fbTimelineEditMLE");z.hideFlyout();b("DOM").replace(d,c.streamStory)}else if(a){d=function(a){a.publish(c,c.streamStory),z.hideFlyout()};c.isFinch&&b("Bootloader").loadModules(["PagesStoryPublisher"],d,"TimelineMLE")}else{a=function(a){var d=b("ge")(c.relativeElementID);b("ReactComposerIDGenerator").isComposerID(d.id)?b("ReactComposerActions").reset(d.id):d&&b("ComposerXController").reset(d);a.publish(c,c.streamStory);z.hideFlyout()};c.isFinch?b("Bootloader").loadModules(["PagesStoryPublisher"],a,"TimelineMLE"):b("Bootloader").loadModules(["TimelineStoryPublisher"],a,"TimelineMLE")}}},startEdit:function(a){z.hideFlyout();var c=b("DOM").scry(a,"div.timelineUnitContainer")[0];b("CSS").hide(c);b("CSS").addClass(a,"fbTimelineEditMLE")},showFlyout:function(a,c,d){__p&&__p();z.hideFlyout();l=a;j=0;b("Arbiter").subscribe("TimelineMLE/mleSelectUpdated",function(a,c){a=b("Parent").byClass(c,"mleContainer");a=b("DOM").scry(a,".registrationLink");if(!a.length)return;c=c.selectedIndex;b("CSS").hide(a[j]);b("CSS").show(a[c]);j=c});a.show();if(c==="edit"&&d){d=b("$")(d);d=b("Parent").bySelector(d,"._5jmm")||b("Parent").byClass(d,"lifeEventContainer");d!==null&&b("CSS").addClass(d,"fbTimelineEditMLE");d=b("DOM").find(a.getInnerContent(),".timelineUnitContainer");b("CSS").addClass(d,"fbTimelineEditMLEFlyout");b("DOMScroll").ensureVisible(d,null,100)}if(c!=="map"){d=b("DOM").scry(a.getInnerContent(),".mleSelect");d.length&&x(d[0])}c!=="edit"&&z.setEstimatedDate(a);b("Arbiter").inform("TimelineMLE/mleFlyoutShown",a)},showPrivacyNotice:function(a,c){if(!c||!a)return;a=b("DOM").find(a.getInnerContent(),".audienceSelector");c.setContext(a).show();m=c;b("Event").listen(a,"click",c.hide.bind(c));b("Event").listen(b("DOM").find(c.getContent(),"input"),"click",c.hide.bind(c));b("Arbiter").subscribe("TimelineMLE/mleFlyoutHidden",c.hide.bind(c))},hideFlyout:function(){if(!l)return;var a=l,c=b("DOM").scry(a.getInnerContent(),".mleContainer")[0];c&&b("TimelineMLEPhotoPreview").destroyPreviewGrid(c);a.hide();k={};l=null;b("Arbiter").inform("TimelineMLE/mleFlyoutHidden")},getFlyout:function(){return l},listenForEditChanges:function(a){__p&&__p();var c=b("DOM").find(a,"form.mleFormContainer"),d=c.elements;for(var e=0;e<d.length;++e){if(b("Parent").byClass(d[e],"uiTypeahead")||b("Parent").byClass(d[e],"uiTokenizer")||b("CSS").hasClass(d[e],"mleSelect"))continue;b("CSS").hasClass(d[e],"inputradio")?b("Event").listen(d[e],"click",q.bind(null,c)):b("Parent").byClass(d[e],"mleDatepicker")?b("Event").listen(d[e],"change",q.bind(null,c)):b("Event").listen(d[e],"blur",q.bind(null,c))}k={element:c,state:b("Form").serialize(c)};e=b("DOM").scry(a,"input.updateRelationshipStatus")[0];e&&b("tidyEvent")(b("Event").listen(e,"change",function(){var a=b("Form").serialize(c);s(c,a)}));var f=b("Arbiter").subscribe("TimelineMLE/mleIconUpdated",function(a,b){return t(c,b)});b("destroyOnUnload")(function(){return b("Arbiter").unsubscribe(f)})},updateHeader:function(a){a=b("Parent").byClass(a,"mleFormContainer");a instanceof HTMLFormElement&&q(a)},informPrivacySelector:function(a,b){b.informTagsChangedWithIDs(a.getTokenValues())},setEstimatedDate:function(a){var c=b("DOM").scry(a.getContentRoot(),".fbTimelineComposerUnit")[0];if(!c){c=b("ProgressiveDatepicker").getInstance(b("DOM").scry(a.getInnerContent(),".uiProgressiveDatepicker")[0]);c&&b("TimelineComposerUtilities").setEstimatedDate(c,p(a))}},updatePrivacyNoticePosition:function(){m&&m.updatePosition()},registerOptionHandler:function(a){a=b("DOM").scry(a,".lifeEventContainer")[0];a=b("DOM").scry(a,".mleSelect");a.length&&x(a[0])},subscribeToTypeahead:function(a,b){a.subscribe(["select","reset","blur"],z.updateHeader.bind(null,b))},subscribeToTokenizer:function(a,c,d){a.subscribe(["addToken","removeToken"],function(){z.updateHeader(c);if(d){var e=b("PrivacySelector").getAdamaSelectorInstance(d);e&&z.informPrivacySelector(a,e)}})},replaceYearlySummary:function(a){w("pagelet_yearly",a),z.hideFlyout()},replaceHometown:function(a){w("pagelet_hometown",a),z.hideFlyout()},showScrapbookPopover:function(a){var c=b("XFamilyNonUserCreationFormController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(c).setData({existing_relationship_id:a.existing_relationship_id,name:a.name,relation:a.relation,source:a.source,birth_month:a.birth_month,birth_day:a.birth_day,birth_year:a.birth_year,privacy_row:a.privacy_row,relationship_type:a.relationship_type}).send()}};e.exports=z}),null);